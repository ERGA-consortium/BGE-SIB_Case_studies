Material and methods (as reported in Piergiorgio Massa PhD thesis - Chapter 3)

Sample collection

The same set of modern and ancient Atlantic bluefin tuna (Thunnus thynnus) specimens described in Andrews et al. (2025) is analyzed here (Figure 1A). Contemporary larvae or young-of-the-year specimens (Gulf of Mexico; Western Mediterranean-Balearic Islands; Central Mediterranean-Sicily; Eastern Mediterranean-Levantine Sea; n = 40, Figure 1A) were collected from the major spawning sites between 2013 and 2018. In addition, adult bluefin tuna (n = 10) were sampled off the Norwegian coast in 2018; this area is not a spawning site, and individuals may have originated from any spawning area. Larval or muscle tissue from each specimen was preserved in 96% ethanol and stored at -20 °C until extraction. Ancient samples comprised archived vertebrae (n = 12) retrieved from the Massimo Sella Archive (51) and pertaining to two tuna-trap catches of 1941 (Istanbul, Türkiye) and 1925 (Zliten, Libya). Additional ancient material consisted of archaeological vertebrae (n = 32) recovered from several Norwegian and Mediterranean excavations spanning the past five millennia, including 1750-1850 (Marseille Harbour, Marseille, France), 1600-1800 (Pedras de Fogu, Sassari, Italy), 900-1200 (Sicily, Italy), 800-1300 (Yenikapı, Istanbul, Türkiye), and ca. 3000 BCE (Jortveit, Norway). Further sample details are provided in the SI Appendix of Andrews et al. (2025).

DNA extraction, library preparation and sequencing

We resequenced the same DNA libraries described in Andrews et al. (2025); readers are referred there for full details of DNA extraction and library preparation for both ancient and modern material. Briefly, libraries were multiplexed into one pool for modern samples and five pools for ancient samples. Pooling was intentionally unbalanced to achieve comparable yields, with samples apportioned by endogenous DNA content and library molarity estimated from an initial screening run. These pools were first sequenced (150-bp paired-end) on HiSeq 4000 or NovaSeq S4 instruments at the Norwegian Sequencing Center (Oslo, Norway) and at Macrogen (Seoul, South Korea / Amsterdam, Netherlands), reaching the depths reported by Andrews et al. (2025), approximately 11.9× for modern and 9.9× for ancient libraries. Because the lower coverage and inherent DNA fragmentation of ancient material had limited locus recovery in prior analyses, we prioritized boosting ancient coverage. After prospective simulations to compare alternative allocation schemes, we carried out a final resequencing round on a NovaSeq X Plus at Novogene UK (Cambridge), allocating one 10B lane to the modern pool and four 25B lanes to the ancient pools.

Reference genome

All analyses were conducted against the chromosome-level Atlantic bluefin tuna (Thunnus thynnus) reference genome (primary assembly GCA_963924715.1 (72)). The reference specimen was a young-of-the-year collected in Italian waters during scientific tagging and survey activities in the Tyrrhenian and Ionian Seas. The final assembly spans 799.05 Mb across 119 scaffolds (468 gaps) with a scaffold N50 of 34.32 Mb; 99.16% of the sequence is assigned to 24 chromosomal pseudomolecules. Combined primary and alternate assemblies achieve an estimated QV of 60.3 and 99.87% k-mer recovery (primary 84.08%, alternate 83.23%). BUSCO v5.5.0 (actinopterygii_odb10, n = 3,640) reports 99.2% completeness (98.5% single-copy, 0.7% duplicated), and the assembly meets the Earth BioGenome Project reference standard 6.C.Q60. The primary haplotype was assembled from PacBio HiFi long reads (30.14 Gb; ~37× coverage) and scaffolded with Hi-C data (145.99 Gb); assembly and curation involved Hifiasm-based assembly, removal of haplotypic duplications, HiC-guided scaffolding, and manual correction of 49 misjoins (removal of seven haplotypic duplications). Genome annotation (Ensembl Rapid Release, EBI) comprises 41,743 transcribed mRNAs from 23,266 protein-coding and 3,826 non-coding genes (average transcript length 18,413 bp; 1.54 coding transcripts per gene; 10.77 exons per transcript).

Reads processing

Ancient and modern reads were processed with PALEOMIX (v1.3.9 (82)), a pipeline for high-throughput aDNA data. Prior to PALEOMIX, NovaSeq-associated poly-G artefacts were mitigated with fastp (v0.23.4 (83)). Quality trimming at Phred ≥30 was also implemented by trimming low-quality bases from both read ends and removing reads with >40% low-quality bases or with >5 ambiguous bases (N). Within PALEOMIX, paired reads were merged/collapsed and adapters removed with AdapterRemoval (v2.2 (84)), then aligned to the reference with BWA-MEM (v0.7.15 (85)). Only reads ≥30 bp were aligned, and only alignments with MAPQ ≥30 were retained for downstream analyses. PCR duplicates were removed with Picard Tools (v1.137 (86)). Post-mortem damage profiles were assessed with mapDamage (v2.2.1 (87)). To reduce deamination-induced misincorporations, 3 bp were trimmed from both ends of all mapped reads (ancient and modern) using bamUtil TrimBam (v1.0.15 (88)). Mean depth was computed per sample with Pandepth (v2.26 (89)). Finally, single-nucleotide variants were jointly called across all samples with GATK (v4.3 (90)) (HaplotypeCaller → GenomicsDBImport → GenotypeGVCFs) using default settings and allowing a maximum of two alternate alleles.

Dataset filtering

SNPs were filtered using conservative, established criteria. First, Indels were removed and only biallelic SNPs retained with VCFtools (v0.1.15 (91)). Hard filters targeting strand bias (FS, SOR), depth-normalized site quality (QD), and mapping performance (MQ) were applied with BCFtools (v1.6 (92)) using: bcftools filter -i "FS>60.0 || SOR>4.0 || QD<2.0 || MQ<30 || MQRankSum<-12.5 || ReadPosRankSum<-8.0". Here, MQRankSum tests whether reads supporting the ALT allele have systematically lower mapping qualities than those supporting the REF allele (negative values indicate poorer mapping of ALT reads), and ReadPosRankSum tests whether ALT alleles are preferentially observed near read ends relative to REF alleles (negative values indicate end-biased ALT observations), both patterns consistent with misalignment or sequence-context artefacts. Additional VCFtools filters enforced GQ ≥ 30 and QUAL ≥ 30 to exclude low-confidence genotypes and sites susceptible to aDNA damage or uneven coverage. Indeed, genotypes with depth DP < 10 were set to missing to limit false homozygotes; this depth threshold was doubled relative to Andrews et al. (2025) owing to increased sequencing depth in the present dataset. A custom Python script then removed genotype calls with depth DP > 2.5× the sample’s mean depth (estimate from Pandepth) to eliminate depth outliers. Singletons were excluded via a minor-allele count (MAC) filter. Missingness was controlled per temporal group with a custom Python script to generate a balanced dataset: a site was removed if missingness exceeded 10% in either modern or ancient samples (computed per group), rather than only when exceeding 10% overall, as normally computed by vcf manipulation softwares (e.g. VCFtools). To further mitigate aDNA deamination, all transitions (C↔T, G↔A) were excluded, yielding a transversions-only SNP set for downstream analyses. To minimize mapping artefacts from repetitive and low-complexity DNA, two complementary filters were applied. First, the reference genome was soft-masked with RepeatMasker (v4.1.9 (93)) using the Actinopterygii repeat library to identify interspersed repeats and low-complexity tracts; variants overlapping masked coordinates were excluded. This annotation-based mask removes sites in known repeats (e.g., transposons, simple repeats) that are prone to spurious alignments. Second, an SNPable (94) mappability mask was generated to capture regions that are difficult to map even if not annotated as repeats. Briefly, all overlapping k-mers of length k were extracted from the reference, remapped to the genome, and each position was scored by the fraction of overlapping k-mers that map uniquely (i.e., without equally good secondary hits). Parameters typical for short reads were used (k = 30, stringency r = 0.5), and positions with mask score <3 (not uniquely mappable) were removed prior to analysis. Applying the union of these masks eliminates loci susceptible to multi-mapping, paralogous alignment, or context artefacts, thereby reducing false positives while retaining confidently mappable, non-repetitive sites. Loci deviating from Hardy-Weinberg equilibrium (HWE) were not excluded a priori. Although extreme excesses of heterozygosity or homozygosity can reflect technical artefacts (95,96), the analyses target loci potentially under selection, which are expected to depart from HWE (97). As a sensitivity check, sites with P < 0.001 in a site-specific exact HWE test across all samples (VCFtools) were removed in a separate run; only very few loci were affected, and downstream summaries were unchanged, indicating no material impact on inference. To retain sufficient loci under this conservative scheme, stringent per-sample filtering was applied. A minimum mean depth of 10× per individual was required, chosen as a compromise between sample retention and SNP yield; 13 samples were excluded at this step. For the same reason, and given their very small sample size, the three ancient Norwegian individuals dated to ~3000 BCE were removed from the main SNP-based dataset but will be later reintroduced for supplementary analyses to examine deep-time continuity. Potential sample non-independence was assessed with pairwise relatedness in VCFtools (--relatedness2); five samples were removed due to kinship coefficients > 0.35. Overall, these filters produced a final set of 764,203 SNPs from 77 individuals (43 modern, 34 ancient; Figure 1A).

Overall genetic diversity

Principal component analysis (PCA) was performed in PLINK (v1.9 (98)). For PCA only, loci deviating from Hardy-Weinberg equilibrium were temporarily excluded with VCFtools (exact test, P < 0.001); linkage disequilibrium pruning was then applied with PLINK --indep-pairwise 200 50 0.2, retaining 301,064 SNPs. PCA can be sensitive to technical artefacts (99), so results were treated as exploratory. Because the dominant axis separated western and eastern Atlantic individuals and the study focuses on temporal contrasts within the east, nine western individuals were removed (Figure 1B). Consequently, the MAC and per-group missingness filters were re-applied to the eastern Atlantic (EATL) subset, yielding 695,465 SNPs. LD pruning, HWE filtering, and PCA were then repeated on the EATL subset; the nine western individuals were excluded from all subsequent analyses and will be incorporated in supplementary analyses to contextualize the western stock relative to the eastern stock. Per-individual heterozygosity (proportion of heterozygous sites) was calculated in VCFtools from the unpruned set of 695,465 SNPs restricted to the 68 eastern Atlantic individuals. As a proxy for inbreeding, runs of homozygosity (ROH) were identified in VCFtools (--LROH) from the same dataset; ROH segments <50,000 bp were discarded, and the remaining segments were merged across adjacent/overlapping intervals to define continuous tracts. For each individual, inbreeding was summarized as FROH (the fraction of the genome within ROH) and by the mean ROH length. Wilcoxon rank-sum tests (100) were performed to judge the statistical significance of summary statistic differentiation between sample groups, with p-values adjusted using false discovery rate (FDR) control (Benjamini-Hochberg (101)).

Allele polarization

Allele polarization was performed with est-sfs (v2.0.4 (102)), which estimates, for each variable site, the posterior probability that a given allele is ancestral by combining ingroup allele counts with one or more outgroup genotypes under an explicit substitution model. est-sfs returns per-site posterior probabilities, allowing SNPs to be unfolded (polarized) while flagging ambiguous cases; sites with weak support can be left unpolarized (or set to missing) to avoid bias. As outgroups, two Thunnus taxa with public whole-genome data were used: southern bluefin (T. maccoyii; PRJNA843977, n = 5; PRJNA327759, n = 2) and yellowfin (T. albacares; PRJNA504596, n = 2; PRJEB12469, n = 1; PRJEB14402, n = 42). Outgroup reads were processed with the same pipeline described above (PALEOMIX), aligned to the T. thynnus reference, and individuals with mean depth <6× were excluded. The retained outgroups comprised 6 T. maccoyii (BioSamples: SAMN29789919, SAMN29789918, SAMN29789917, SAMN29789916, SAMN05383904, SAMN05383906) and 8 T. albacares (BioSamples: SAMEA4032486, SAMEA4032487, SAMEA4032497, SAMEA4032499, SAMEA4032512, SAMEA4032522, SAMEA4032525, SAMEA4028815). These were then jointly genotyped with the eastern Atlantic ingroup (EATL) in GATK to ensure site concordance for downstream polarization. To generate input for est-sfs, the multi-sample VCF (restricted to the EATL panel of 695,465 SNPs) was converted with a custom script (vcf_to_estsfs.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/vcf_to_estsfs.py) that first filters per-sample genotypes by depth (minimum depth 8, with sub-threshold calls set to missing). This threshold was intentionally slightly more permissive than the one used for the ingroup to balance data retention and reliability given the lower depth of coverage of outgroup individuals. For each retained site, the script outputs A/C/G/T allele counts for the ingroup and a single pseudo-haploid base per outgroup, assigned conservatively only when all usable outgroup genotypes are homozygous and concordant; otherwise the outgroup is treated as missing. A per-outgroup completeness threshold of 0.5 was applied, so sites failing this threshold for any outgroup were discarded. After conversion, est-sfs was then executed on a set of 220,170 SNPs to infer the unfolded site-frequency spectrum and per-site ancestral-state posterior probabilities from the ingroup/outgroup allele-count file. Subsequently, the multi-sample VCF was polarized with a custom script (polarize_and_flip_vcf.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/polarize_and_flip_vcf.bash) using the est-sfs outputs: per site, the ancestral/derived state was assigned based on the posterior probability, retaining only high-confidence calls (threshold 0.05-0.95) and discarding ambiguous sites. The VCF was then normalized so that REF is ancestral and ALT is derived, records where the ancestral allele corresponded to ALT were flipped (REF↔ALT) with consistent updates to genotype fields and recalculation of AC/AN/AF. The resulting VCF comprised 207,449 polarized SNPs; each site is annotated with the inferred ancestral allele (AA), derived allele (DER), and posterior support (APR), with REF set to the ancestral and ALT to the derived state.

Functional impact: annotation and comparison

Each of the 207,449 polarized SNPs was then annotated with SnpEff (103), which predicts functional consequences by intersecting variants with reference gene models/coding sequences and assigning Sequence Ontology terms (e.g., missense_variant, synonymous_variant, stop_gained, splice_region_variant, UTR/intronic/upstream/downstream). The SnpEff database was custom-built from the structural annotation of the Thunnus thynnus reference genome (same assembly used for mapping/variant calling), ensuring coordinate and chromosome-name concordance. Based on the predicted consequence, each SNP was classified into one of four impact categories: HIGH (likely disruptive changes such as stop gained/lost, frameshift, start lost, essential splice-site variants), MODERATE (non-disruptive protein changes that may alter function, e.g., missense and in-frame indels), LOW (changes unlikely to affect protein function, e.g., synonymous and splice-region variants), and MODIFIER (non-coding or regulatory context with unknown/indirect effects, e.g., intronic, UTR, upstream/downstream, intergenic). When multiple SnpEff annotations were present due to overlapping transcripts, the first annotation was retained. To quantify shifts between modern (X) and ancient (Y) samples, the Rxy statistic (62,64) (Xue et al., 2015; Dussex et al., 2021) was computed on the polarized, SnpEff-annotated VCF with a custom script (rxy_from_vcf.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/rxy_from_vcf.py). For a given set of sites, Rxy compares the pooled frequency in X to that in Y as Rxy=(fx(1-fy))/(fy(1-fx)), where f is the derived allele frequency. Sites were grouped into SnpEff-defined impact classes, HIGH, MODERATE, LOW, and MODIFIER restricted to intergenic regions, which we treated as a putatively neutral baseline (with caveats detailed in the Discussion). We removed loci showing > 5% X-Y differences in per-site call rate and, when requested, equalized per-site sample sizes between X and Y by randomly down-sampling to the smaller group. Frequencies were computed with a Haldane pseudo-count of 0.5 to avoid zero divisions. Uncertainty and linkage were handled via chromosome-level block bootstrap (1,000 replicates; ≥ 50 sites per block), yielding Rxy point estimates and 95% bootstrap confidence intervals for each impact class. The site-frequency spectrum (SFS) was estimated per SnpEff impact class (HIGH, MODERATE, LOW, MODIFIER:intergenic_region) and per temporal group (modern and ancient) using a custom deterministic projection script (stable_sfs_deterministic.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/stable_sfs_deterministic.py), suited for missing data. Starting from the polarized, SnpEff-annotated VCF, for each site and group the derived-allele count k and the number of called haploids h were tallied. To place groups on a common scale, each group’s SFS was deterministically projected to H = 60 haploid chromosomes (≈ 0.9x the per-group haploid sample size) using the hypergeometric expectation (no random resampling), and expected counts were summed by SnpEff class. Bins fixed for the derived or ancestral allele (0 and H) were excluded. The script produced both unfolded (k'/ H) and folded (minor-allele/H) spectra and their normalized versions (“density” and “fraction”). Uncertainty was quantified with a chromosome-level block bootstrap (1,000 replicates; minimum 50 sites per block).

Modeling selection across a recent bottleneck

A recent, severe but brief bottleneck followed by recovery, as documented for Atlantic bluefin tuna, was simulated in SLiM (v5.0 (104)) using a forward-time Wright-Fisher model to track allele-frequency trajectories across selection classes (TunaLoad_mod1.slim, https://github.com/PiergiorgioMassa/abft_load/blob/main/TunaLoad_mod1.slim; TunaLoad_mod1_bottleneck.slim, https://github.com/PiergiorgioMassa/abft_load/blob/main/TunaLoad_mod1_bottleneck.slim). The genomic model comprised three unlinked genes (3 × 30 kb). The per-site mutation rate was set to μ = 1×10−8 and the within-gene recombination rate to r = 1×10−8 per bp per generation. The between-gene recombination fraction was fixed at 0.5 to enforce independence among genes. Within each gene, neutral and deleterious mutations arose at a 1:2.31 ratio (105). To mimic coarse functional classes, all nonsynonymous mutations within a given gene shared a fixed selection coefficient, using three values s∈{-0.1,-0.01,-0.001} as proxies for high, moderate, and low effects, respectively. Note that functional impact classes do not map one-to-one onto selection coefficients in real genomes. Dominance coefficients were drawn from an hs relationship following Kyriazis et al. (2021) (106), such that more strongly deleterious mutations were modeled as more recessive: h(s)=(1/2)/(1+(7071.07×s)). The modeled census size was N = 100,000, a compromise between the large numbers expected for a pelagic species and computational feasibility. Three independent burn-in runs of 300,000 generations at constant N were used to approach mutation-selection-drift equilibrium; the terminal generation of each burn-in initialized a replicate of the demographic scenario. The bottleneck was implemented as a step reduction to 0.3  N, consistent with fishery-based abundance declines (35). Its duration was set to 10 generations (≈100 years assuming a conservative 10-year generation time (107)), placed in 1900-2000 in line with the timing suggested by recent Ne estimates (26). Population size then recovered to the pre-bottleneck value over the final two generations (2000-2020). To mirror the empirical analysis, we tracked the derived-allele Rxy through time for the tagged mutations in each selection class and summarized its trajectory with uncertainty with python custom scripts (parse_slim_logs.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/parse_slim_logs.py; plot_freq.py, https://github.com/PiergiorgioMassa/abft_load/blob/main/plot_freq.py). For every run, Rxy was computed at generation lag n by contrasting the terminal generation (X) with the state n generations earlier (Y). Mutation-level trajectories were then aggregated per class by binning time before present on a 0-12 generation axis and taking the median Rxy within each bin. To quantify uncertainty, we applied nonparametric bootstrapping over mutation-level units within each class to obtain 95% confidence intervals for the binned medians.
